<%- include('partials/header.ejs'); -%>

<div class="box" id="heading">
  <h1>Search Results</h1>
  <a href="/" class="btn btn-return">‚Üê Retour</a>
</div>

<div class="results">
  <% if (books.length > 0) { %> <% books.forEach(book => { %>
  <div class="book">
    <!--Display the book's cover if exist -->
    <% console.log(book.cover_i) %>
    <img
      src="<%= book.cover_i 
    ? 'https://covers.openlibrary.org/b/id/' + book.cover_i + '-M.jpg' 
    : '/images/no-cover.png' %>"
      alt="Book cover"
    />

    <h2><%= book.title %></h2>

    <p>
      <strong>Author:</strong>
      <%= book.author_name ? book.author_name.join(', ') : 'Unknown' %>
    </p>

    <p>
      <strong>First published:</strong>
      <%= book.first_publish_year || 'N/A' %>
    </p>

    <!-- Button Add to library -->
    <form action="/add-book" method="post">
      <input type="hidden" name="work_key" value="<%= book.key %>" />
      <input type="hidden" name="title" value="<%= book.title %>" />
      <input type="hidden" name="cover_key" value="<%= book.cover_i %>" />
      <input type="hidden" name="author_key" value="<%= book.author_key %>" />
      <input
        type="hidden"
        name="first_publish_year"
        value="<%= book.first_publish_year ? book.first_publish_year : 'unknown' %>"
      />
      <input
        type="hidden"
        name="author_name"
        value="<%= book.author_name ? book.author_name.join(', ') : 'unknown' %>"
      />
      <button type="submit" class="btn btn-add">Add to library</button>
    </form>
  </div>
  <% }) %> <% } else { %>
  <p>No books found.</p>
  <% } %>
</div>

<%- include('partials/footer.ejs'); -%>
